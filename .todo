add better logging and error handling
add socket id support
